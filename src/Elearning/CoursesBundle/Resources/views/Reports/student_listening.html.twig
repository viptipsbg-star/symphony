{% extends "bodybase.html.twig" %}

{% block bodycontainer %}
    <h1>{{ "reports.student_courses.title"|trans }}</h1>
    <div class="content-container">
        <div class="body-panel">
            {% if listenings is empty %}
                <h3 class="no-entries">{{ "reports.student_courses.no_entries"|trans }}</h3>
            {% else %}
                <div class="list-table">
                    <table class="table table-striped table-bordered report-table" data-tablesaw-mode="stack">
                        <thead>
                        <tr>
                            <th>{{ "reports.student_courses.name"|trans }}</th>
                            <th>{{ "reports.student_courses.category"|trans }}</th>
                            <th>{{ "reports.student_courses.completion_date"|trans }}</th>
                            <th>{{ "reports.student_courses.course_hours"|trans }}</th>
                            <th>{{ "reports.student_courses.certificate"|trans }}</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for listening in listenings %}
                            <tr>
                                <td>{{ listening.course.name }}</td>
                                <td class="category">
                                    {% if listening.course.id in categoriesHierarchy %}
                                        {% for category in categoriesHierarchy[listening.course.id] %}
                                            {{ category }}
                                            <span class="separator"></span>
                                        {% endfor %}
                                    {% endif %}
                                    {{ listening.course.category.name }}
                                </td>
                                <td>{{ listening.lastListen|date("Y-m-d H:i:s") }}</td>
                                <td>
                                    {% if listening.isCoursePassed() %}
                                        {{ listening.course.duration }}
                                    {% endif %}
                                </td>
                                <td>
                                    {% if listening.isCoursePassed() and listening.getCourse.getCertificateNeeded %}
                                        <a href="{{ path("elearning_course_certificate", {listening_id: listening.id}) }}"
                                           target="_blank"><img
                                                    src="{{ asset("bundles/elearningcourses/images/pdf_ico.png") }}"/></a>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>
                        <tr class="stacktable-hide">
                            <td class="right" colspan="3">{{ "reports.student_courses.total"|trans }}</td>
                            <td>{{ totalcoursehours }}</td>
                            <td></td>
                        </tr>
                        <tr class="stacktable-only mobile-only">
                            <td class="right">{{ "reports.student_courses.total"|trans }}</td>
                            <td>{{ totalcoursehours }}</td>
                        </tr>
                        </tfoot>
                    </table>
                    <div class="pagination">
                        {{ knp_pagination_render(listenings) }}
                    </div>
                </div>
            {% endif %}
            <div class="list-table">-
                <table class="table table-bordered manual-hours">
                    <tr>
                        <td width="200">{{ "reports.student_courses.manual_course_hours"|trans }}</td>
                        <td>
                            <span class="hours">{{ manualhours }}</span>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

{% endblock %}

{% block stylesheets %}
    {% stylesheets '@ElearningCoursesBundle/Resources/less/styles.less'
    '@ElearningCoursesBundle/Resources/less/responsive.less'
    '../app/Resources/public/css/stacktable.css'filter="cssrewrite" %}
    <link rel="stylesheet" href="{{ asset_url }}">
    {% endstylesheets %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% javascripts '../app/Resources/public/js/stacktable.js' %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
    <script>
        jQuery(document).ready(function ($) {
            $('table.report-table').stacktable();
        });
    </script>
{% endblock %}
